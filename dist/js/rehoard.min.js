!function(e){function t(n){if(s[n])return s[n].exports;var i=s[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var s={};return t.m=e,t.c=s,t.p="",t(0)}([function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=s(3),r=n(i);e.exports=function(){try{return window.ReHoard=r["default"],window.ReHoard}catch(e){return r["default"]}}()},function(e,t){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),i=function(){function e(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];s(this,e),this.production=t}return n(e,[{key:"changeEnviroment",value:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];this.production=e}},{key:"error",value:function(e){this.production||console.error(e)}},{key:"warn",value:function(e){this.production||console.error(e)}},{key:"info",value:function(e){this.production||console.error(e)}},{key:"log",value:function(e){this.production||console.error(e)}},{key:"debug",value:function(e){this.production&&console.error(e)}}]),e}();t["default"]=i},function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),u=s(1),a=n(u),c=function(){function e(){i(this,e),this.changeSettings(null),this._states={},this._actions_history=[],this._storageName="ReHoard",this._persistanceLoad(),this._willSubscribeWhenAlive=[],this._debug}return o(e,[{key:"changeSettings",value:function(e){this._settings={persistance:{persist:!e||!e.persist||e.persist,session:!e||!e.session||e.session,timeAlive:e&&e.timeAlive?e.timeAlive:1},undoRedo:!e||!e.undoRedo||e.undoRedo,actionsHistory:!e||!e.actionsHistory||e.actionsHistory,actionsHistoryLimit:e&&e.actionsHistoryLimit?e.actionsHistoryLimit:100,typeMutable:!(!e||!e.typeMutable)&&e.typeMutable,production:!e||!e.production||e.production},this._debug=new a["default"](this._settings.production)}},{key:"dispatch",value:function(e,t){var s=arguments.length<=2||void 0===arguments[2]?"":arguments[2],n=!1;if(!e||!t)return this._debug.error("Null parameters dispatched "),n;if("string"!=typeof s)return this._debug.error("An action must be a string type"),n;if(this._states.hasOwnProperty(e)){var i=this._states[e];this._update(i,e,t,s),this._notifysubscribers(i),n=!0}else this._create(e,t,s),n=!0;return this._persistanceSave(),n}},{key:"subscribeWhenBecomesAlive",value:function(e,t,s){return this._states.hasOwnProperty(e)&&t?this.subscribe(e,t):this._willSubscribeWhenAlive.push({name:e,listener:t,unSubscribeCB:s})}},{key:"subscribe",value:function(e,t){var s=this;if(!this._states.hasOwnProperty(e)||!t)return this._debug.warn(e+" does not exits yet... Cannot subscribe... :("),!1;var n=function(){var n=s._states[e],i=n.subscribers.push({listener:t,unSubscribeCB:void 0});return s._a_history(n,"Listener Subscribed"),s._notifysubscribers(n),{v:{unSubscribe:function(){s._unSubscribe(e,i)}}}}();return"object"===("undefined"==typeof n?"undefined":r(n))?n.v:void 0}},{key:"broadcastState",value:function(e){var t=!1;if(this._states.hasOwnProperty(e)){var s=this._states[e];this._notifysubscribers(s),t=!0}else this._debug.warn("getCurrentState failed to find state, check your state name");return t}},{key:"getCurrentValue",value:function(e){if(this._states.hasOwnProperty(e)){var t=this._states[e];return t.value}return null}},{key:"deleteState",value:function(e){var t=!1;return this._states.hasOwnProperty(e)?(this._a_history(this._states[e],"State Deleted"),this._persistanceSave(),delete this._states[e],t=!this._states[e]):this._debug.error(e+" does not exits yet... Cannot delete"),t}},{key:"redo",value:function(e){var t=!1;if(this._settings.undoRedo&&e&&this._states.hasOwnProperty(e)){var s=this._states[e];if(s.redoStack.length>0){s.undoStack.push({value:s.value,action:s.actionReference});var n=s.redoStack.pop();s.value=n.value,s.actionReference=n.actionReference,this._a_history(s,"Redo"),this.getCurrentState(e),this._persistanceSave(),t=!0}}return t}},{key:"undo",value:function(e){var t=!1;if(this._settings.undoRedo&&e&&this._states.hasOwnProperty(e)){var s=this._states[e];if(s.undoStack.length>0){s.redoStack.push({value:s.value,action:s.actionReference});var n=s.undoStack.pop();s.value=n.value,s.actionReference=n.actionReference,this._a_history(s,"Undo"),this.getCurrentState(e),this._persistanceSave(),t=!0}}return t}},{key:"_unSubscribe",value:function(e,t){var s=!1;if(this._states.hasOwnProperty(e)&&e&&t){var n=this._states[e];n.subscribers[t-1]=null,this._a_history(n,"unSubcribed"),s=!0}else this._debug.warn(e+" does not exits yet... Cannot unSubcribe... :(");return s}},{key:"_create",value:function(e,t,s){var n=this._states[e]={};n.typeOfElement="undefined"==typeof t?"undefined":r(t),n.name=e,n.value=t,this._willSubscribeWhenAlive.length>0?this._willSubscribeCore(n):n.subscribers=[],n.action=s,this._settings.undoRedo&&(n.undoStack=[],n.redoStack=[]),this._notifysubscribers(n),this._a_history(n,"Created")}},{key:"_update",value:function(e,t,s,n){if(this._settings.typeMutable)e.typeOfElement="undefined"==typeof s?"undefined":r(s);else if(e.typeOfElement!==("undefined"==typeof s?"undefined":r(s)))return void this._debug.error("Error, mutability violated for: "+e.name);this._settings.undoRedo&&(e.undoStack.length>=100&&e.undoStack.splice(parseInt(0,parseInt(e.undoStack.length/2))),e.undoStack.push({value:e.value,action:e.actionReference}),e.redoStack=[]),e.value=s,e.action=n,this._a_history(e,"Updated")}},{key:"_willSubscribeCore",value:function(e){var t=this,s=this._willSubscribeWhenAlive.filter(function(t){return t.name===e.name});e.subscribers=s.map(function(e){return{listener:e.listener,unSubscribeCB:e.unSubscribeCB}}),e.subscribers.forEach(function(e,s){try{e.unSubscribeCB&&e.unSubscribeCB({unSubscribe:function(){t._unSubscribe(e.name,s)}})}catch(n){t._debug.warn(n)}})}},{key:"_notifysubscribers",value:function(e){if(e&&e.subscribers.length>0){for(var t=0;t<e.subscribers.length;t++)try{e.subscribers[t]&&null!==e.subscribers[t].listener&&e.subscribers[t].listener(e.value)}catch(s){this._debug.warn(e.subscribers[t].listener+" No longer in scope")}this._a_history(e,"Notified Subscribers")}}},{key:"_persistanceSave",value:function(){if(this._settings.persistance.persist){var e=void 0;e=this._settings.persistance.session?sessionStorage:localStorage;try{var t={date:new Date,states:this._states};e.setItem(this._storageName,JSON.stringify(t))}catch(s){console.log(s)}}}},{key:"_persistanceLoad",value:function(){if(this._settings.persistance.persist){var e=void 0;e=this._settings.persistance.session?sessionStorage:localStorage;try{var t=e.getItem(this._storageName);if(t){var s=JSON.parse(t),n=new Date(s.date);if(n.setDate(n.getDate()+this._settings.timeAlive),n<new Date)e.removeItem(this._storageName);else{var i=Object.assign({},s.states);for(var r in i)i[r].subscribers=[];this._states=i}}}catch(o){this._debug.log(o)}}}},{key:"_a_history",value:function(e,t){this._settings.actionsHistory&&(this._actions_history.length>=this._settings.actionsHistoryLimit&&this._actions_history.splice(parseInt(0,parseInt(this._actions_history.length/2))),this._actions_history.push({action:t,state:Object.assign({},e),date:new Date}))}}]),e}();t["default"]=c},function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),o=s(2),u=n(o),a=function(){function e(){i(this,e),this._reHoardPubSub=new u["default"],window.StateHub=this}return r(e,[{key:"changeSettings",value:function(e){this._reHoardPubSub.changeSettings(e)}},{key:"create",value:function(e,t){return this._reHoardPubSub._create(e,t,"CREATION")}},{key:"dispatch",value:function(e,t){var s=arguments.length<=2||void 0===arguments[2]?"":arguments[2];return this._reHoardPubSub.dispatch(e,t,s)}},{key:"subscribe",value:function(e,t){return this._reHoardPubSub.subscribe(e,t)}},{key:"subscribeWhenBecomesAlive",value:function(e,t,s){return this._reHoardPubSub.subscribeWhenBecomesAlive(e,t,s)}},{key:"broadcastState",value:function(e){return this._reHoardPubSub.broadcastState(e)}},{key:"getCurrentState",value:function(e){return this._reHoardPubSub.getCurrentValue(e)}},{key:"deleteState",value:function(e){return this._reHoardPubSub.deleteState(e)}},{key:"redo",value:function(e){return this._reHoardPubSub.redo(e)}},{key:"undo",value:function(e){return this._reHoardPubSub.undo(e)}}]),e}();t["default"]=a}]);