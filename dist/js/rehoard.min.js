!function(e){function t(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return e[i].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var s=n(3),r=i(s);e.exports=function(){return window.ReHoard?window.ReHoard:(window.ReHoard=new r["default"],window.ReHoard)}()},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];n(this,e),this.production=t}return i(e,[{key:"changeEnviroment",value:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];this.production=e}},{key:"error",value:function(e){this.production||console.error(e)}},{key:"warn",value:function(e){this.production||console.error(e)}},{key:"info",value:function(e){this.production||console.error(e)}},{key:"log",value:function(e){this.production||console.error(e)}},{key:"debug",value:function(e){this.production&&console.error(e)}}]),e}();t["default"]=s},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(1),a=i(u),c=function(){function e(){s(this,e),this.changeSettings(null),this._states={},this._actions_history=[],this._storageName="ReHoard",this._persistanceLoad(),this._willSubscribeWhenAlive=[],this._debug}return o(e,[{key:"changeSettings",value:function(e){this._settings={persistance:{persist:!e||!e.persist||e.persist,session:!e||!e.session||e.session,timeAlive:e&&e.timeAlive?e.timeAlive:1},undoRedo:!e||!e.undoRedo||e.undoRedo,actionsHistory:!e||!e.actionsHistory||e.actionsHistory,actionsHistoryLimit:e&&e.actionsHistoryLimit?e.actionsHistoryLimit:100,typeMutable:!(!e||!e.typeMutable)&&e.typeMutable,production:!e||!e.production||e.production},this._debug=new a["default"](this._settings.production)}},{key:"dispatch",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2],i=!1;if(!e||!t)return this._debug.error("Null parameters dispatched "),i;if("string"!=typeof n)return this._debug.error("An action must be a string type"),i;if(this._states.hasOwnProperty(e)){var s=this._states[e];this._update(s,e,t,n),this._notifysubscribers(s),i=!0}else this._create(e,t,n),i=!0;return this._persistanceSave(),i}},{key:"subscribeWhenBecomesAlive",value:function(e,t,n){return this._states.hasOwnProperty(e)&&t?this.subscribe(e,t):this._willSubscribeWhenAlive.push({name:e,listener:t,unSubscribeCB:n})}},{key:"subscribe",value:function(e,t){var n=this;if(!this._states.hasOwnProperty(e)||!t)return this._debug.warn(e+" does not exits yet... Cannot subscribe... :("),!1;var i=function(){var i=n._states[e],s=i.subscribers.push({listener:t,unSubscribeCB:void 0});return n._a_history(i,"Listener Subscribed"),n._notifysubscribers(i),{v:{unSubscribe:function(){n._unSubscribe(e,s)}}}}();return"object"===("undefined"==typeof i?"undefined":r(i))?i.v:void 0}},{key:"getCurrentState",value:function(e){var t=!1;if(this._states.hasOwnProperty(e)){var n=this._states[e];this._notifysubscribers(n),t=!0}else this._debug.warn("getCurrentState failed to find state, check your state name");return t}},{key:"deleteState",value:function(e){var t=!1;return this._states.hasOwnProperty(e)?(this._a_history(this._states[e],"State Deleted"),this._persistanceSave(),delete this._states[e],t=!this._states[e]):this._debug.error(e+" does not exits yet... Cannot delete"),t}},{key:"redo",value:function(e){var t=!1;if(this._settings.undoRedo&&e&&this._states.hasOwnProperty(e)){var n=this._states[e];if(n.redoStack.length>0){n.undoStack.push({value:n.value,action:n.actionReference});var i=n.redoStack.pop();n.value=i.value,n.actionReference=i.actionReference,this._a_history(n,"Redo"),this.getCurrentState(e),this._persistanceSave(),t=!0}}return t}},{key:"undo",value:function(e){var t=!1;if(this._settings.undoRedo&&e&&this._states.hasOwnProperty(e)){var n=this._states[e];if(n.undoStack.length>0){n.redoStack.push({value:n.value,action:n.actionReference});var i=n.undoStack.pop();n.value=i.value,n.actionReference=i.actionReference,this._a_history(n,"Undo"),this.getCurrentState(e),this._persistanceSave(),t=!0}}return t}},{key:"_unSubscribe",value:function(e,t){var n=!1;if(this._states.hasOwnProperty(e)&&e&&t){var i=this._states[e];i.subscribers[t-1]=null,this._a_history(i,"unSubcribed"),n=!0}else this._debug.warn(e+" does not exits yet... Cannot unSubcribe... :(");return n}},{key:"_create",value:function(e,t,n){var i=this._states[e]={};i.typeOfElement="undefined"==typeof t?"undefined":r(t),i.name=e,i.value=t,this._willSubscribeWhenAlive.length>0?this._willSubscribeCore(i):i.subscribers=[],i.action=n,this._settings.undoRedo&&(i.undoStack=[],i.redoStack=[]),this._notifysubscribers(i),this._a_history(i,"Created")}},{key:"_update",value:function(e,t,n,i){if(this._settings.typeMutable)e.typeOfElement="undefined"==typeof n?"undefined":r(n);else if(e.typeOfElement!==("undefined"==typeof n?"undefined":r(n)))return void this._debug.error("Error, mutability violated for: "+e.name);this._settings.undoRedo&&(e.undoStack.length>=100&&e.undoStack.splice(parseInt(0,parseInt(e.undoStack.length/2))),e.undoStack.push({value:e.value,action:e.actionReference}),e.redoStack=[]),e.value=n,e.action=i,this._a_history(e,"Updated")}},{key:"_willSubscribeCore",value:function(e){var t=this,n=this._willSubscribeWhenAlive.filter(function(t){return t.name===e.name});this._willSubscribeWhenAlive=this._willSubscribeWhenAlive.filter(function(e){return n.indexOf(e)<0}),e.subscribers=n.map(function(e){return{listener:e.listener,unSubscribeCB:e.unSubscribeCB}}),e.subscribers.forEach(function(e,n){try{e.unSubscribeCB&&e.unSubscribeCB({unSubscribe:function(){t._unSubscribe(e.name,n)}})}catch(i){t._debug.warn(i)}})}},{key:"_notifysubscribers",value:function(e){if(e&&e.subscribers.length>0){for(var t=0;t<e.subscribers.length;t++)try{e.subscribers[t]&&null!==e.subscribers[t].listener&&e.subscribers[t].listener(e.value)}catch(n){this._debug.warn(e.subscribers[t].listener+" No longer in scope")}this._a_history(e,"Notified Subscribers")}}},{key:"_persistanceSave",value:function(){if(this._settings.persistance.persist){var e=void 0;e=this._settings.persistance.session?sessionStorage:localStorage;try{var t={date:new Date,states:this._states};e.setItem(this._storageName,JSON.stringify(t))}catch(n){console.log(n)}}}},{key:"_persistanceLoad",value:function(){if(this._settings.persistance.persist){var e=void 0;e=this._settings.persistance.session?sessionStorage:localStorage;try{var t=e.getItem(this._storageName);if(t){var n=JSON.parse(t),i=new Date(n.date);if(i.setDate(i.getDate()+this._settings.timeAlive),i<new Date)e.removeItem(this._storageName);else{var s=Object.assign({},n.states);for(var r in s)s[r].subscribers=[];this._states=s}}}catch(o){this._debug.log(o)}}}},{key:"_a_history",value:function(e,t){this._settings.actionsHistory&&(this._actions_history.length>=this._settings.actionsHistoryLimit&&this._actions_history.splice(parseInt(0,parseInt(this._actions_history.length/2))),this._actions_history.push({action:t,state:Object.assign({},e),date:new Date}))}}]),e}();t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(2),u=i(o),a=function(){function e(){s(this,e),this._reHoardPubSub=new u["default"],window.StateHub=this}return r(e,[{key:"changeSettings",value:function(e){this._reHoardPubSub.changeSettings(e)}},{key:"dispatch",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2];return this._reHoardPubSub.dispatch(e,t,n)}},{key:"subscribe",value:function(e,t){return this._reHoardPubSub.subscribe(e,t)}},{key:"subscribeWhenBecomesAlive",value:function(e,t,n){return this._reHoardPubSub.subscribeWhenBecomesAlive(e,t,n)}},{key:"getCurrentState",value:function(e){return this._reHoardPubSub.getCurrentState(e)}},{key:"deleteState",value:function(e){return this._reHoardPubSub.deleteState(e)}},{key:"redo",value:function(e){return this._reHoardPubSub.redo(e)}},{key:"undo",value:function(e){return this._reHoardPubSub.undo(e)}}]),e}();t["default"]=a}]);